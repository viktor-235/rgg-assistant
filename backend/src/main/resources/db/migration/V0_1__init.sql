-- Games

CREATE TABLE game (
  id BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
  name VARCHAR(255) NOT NULL,
  info_link VARCHAR(255),
  CONSTRAINT pk_game PRIMARY KEY (id)
);

CREATE TABLE platform (
  id BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
  name VARCHAR(255) NOT NULL,
  release_date TIMESTAMP WITH TIME ZONE,
  CONSTRAINT pk_platform PRIMARY KEY (id)
);

CREATE TABLE game_platform (
  id BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
  game_id BIGINT,
  platform_id BIGINT NOT NULL,
  CONSTRAINT pk_game_platform PRIMARY KEY (id)
);
ALTER TABLE game_platform ADD CONSTRAINT FK_GAME_PLATFORM_ON_GAME FOREIGN KEY (game_id) REFERENCES game (id);
ALTER TABLE game_platform ADD CONSTRAINT FK_GAME_PLATFORM_ON_PLATFORM FOREIGN KEY (platform_id) REFERENCES platform (id);

CREATE TABLE collected_game_platform (
  id BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
  collection_date TIMESTAMP WITH TIME ZONE NOT NULL,
  status VARCHAR(255),
  spent_time INTERVAL SECOND(8),
  comment VARCHAR(1023),
  game_platform_id BIGINT,
  CONSTRAINT pk_collected_game_platform PRIMARY KEY (id)
);
ALTER TABLE collected_game_platform ADD CONSTRAINT FK_COLLECTED_GAME_PLATFORM_ON_GAME_PLATFORM FOREIGN KEY (game_platform_id) REFERENCES game_platform (id);

-- Effects

CREATE SEQUENCE modifier_seq START WITH 1 INCREMENT BY 1;

CREATE TABLE effect (
  id BIGINT DEFAULT NEXT VALUE FOR modifier_seq NOT NULL,
  name VARCHAR(255),
  description VARCHAR(1023),
  type VARCHAR(255),
  CONSTRAINT pk_effect PRIMARY KEY (id)
);

CREATE TABLE collected_effect (
  id BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
  effect_id BIGINT,
  CONSTRAINT pk_collected_effect PRIMARY KEY (id)
);
ALTER TABLE collected_effect ADD CONSTRAINT FK_COLLECTED_EFFECT_ON_EFFECT FOREIGN KEY (effect_id) REFERENCES effect (id);

-- Items

CREATE TABLE item (
  id BIGINT DEFAULT NEXT VALUE FOR modifier_seq NOT NULL,
  name VARCHAR(255),
  description VARCHAR(1023),
  CONSTRAINT pk_item PRIMARY KEY (id)
);

CREATE TABLE collected_item (
  id BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
  item_id BIGINT,
  CONSTRAINT pk_collected_item PRIMARY KEY (id)
);
ALTER TABLE collected_item ADD CONSTRAINT FK_COLLECTED_ITEM_ON_ITEM FOREIGN KEY (item_id) REFERENCES item (id);
